{
  "id": "dd9ec244-01b3-40da-802a-03c28630ae35",
  "revision": 0,
  "last_node_id": 19,
  "last_link_id": 20,
  "nodes": [
    {
      "id": 1,
      "type": "HunyuanImageAdvancedLoader",
      "pos": [
        50,
        100
      ],
      "size": [
        400,
        702
      ],
      "flags": {},
      "order": 0,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "pipeline",
          "type": "HUNYUAN_PIPELINE",
          "links": [
            1,
            2,
            3,
            4
          ]
        },
        {
          "name": "config",
          "type": "HUNYUAN_CONFIG",
          "links": [
            5
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "HunyuanImageAdvancedLoader"
      },
      "widgets_values": [
        "hunyuanimage-v2.1",
        "cuda",
        true,
        "int8",
        "bf16",
        false,
        "int8",
        "bf16",
        true,
        "int4",
        "bf16",
        true,
        false,
        false,
        false,
        false,
        "inductor",
        "max-autotune",
        false,
        true,
        true,
        false,
        false,
        true,
        false,
        true,
        false
      ]
    },
    {
      "id": 2,
      "type": "HunyuanImageMemoryManager",
      "pos": [
        71.18204498291016,
        872.1907348632812
      ],
      "size": [
        350,
        120
      ],
      "flags": {},
      "order": 3,
      "mode": 0,
      "inputs": [
        {
          "name": "pipeline",
          "type": "HUNYUAN_PIPELINE",
          "link": 1
        }
      ],
      "outputs": [
        {
          "name": "pipeline",
          "type": "HUNYUAN_PIPELINE",
          "links": null
        },
        {
          "name": "info",
          "type": "STRING",
          "links": [
            16
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "HunyuanImageMemoryManager"
      },
      "widgets_values": [
        "clear_cache"
      ]
    },
    {
      "id": 4,
      "type": "HunyuanImagePromptEnhancer",
      "pos": [
        518.3074951171875,
        67.08686065673828
      ],
      "size": [
        400,
        200
      ],
      "flags": {},
      "order": 4,
      "mode": 0,
      "inputs": [
        {
          "name": "pipeline",
          "type": "HUNYUAN_PIPELINE",
          "link": 2
        }
      ],
      "outputs": [
        {
          "name": "enhanced_prompt",
          "type": "STRING",
          "links": [
            18,
            20
          ]
        },
        {
          "name": "original_prompt",
          "type": "STRING",
          "links": [
            19
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "HunyuanImagePromptEnhancer"
      },
      "widgets_values": [
        "A futuristic cyberpunk city with neon lights, flying cars, and towering skyscrapers under a purple sky"
      ]
    },
    {
      "id": 7,
      "type": "HunyuanImageSampler",
      "pos": [
        496.33843994140625,
        420.8285217285156
      ],
      "size": [
        400,
        500
      ],
      "flags": {},
      "order": 8,
      "mode": 0,
      "inputs": [
        {
          "name": "pipeline",
          "type": "HUNYUAN_PIPELINE",
          "link": 3
        },
        {
          "name": "model_info",
          "shape": 7,
          "type": "HUNYUAN_MODEL_INFO",
          "link": null
        },
        {
          "name": "positive",
          "type": "STRING",
          "widget": {
            "name": "positive"
          },
          "link": 20
        }
      ],
      "outputs": [
        {
          "name": "latent",
          "type": "LATENT",
          "links": [
            9
          ]
        },
        {
          "name": "image",
          "type": "IMAGE",
          "links": [
            10,
            11
          ]
        },
        {
          "name": "info",
          "type": "STRING",
          "links": [
            17
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "HunyuanImageSampler"
      },
      "widgets_values": [
        "",
        "blurry, low quality, distorted, ugly, bad anatomy, watermark, text",
        2048,
        2048,
        75,
        5,
        42,
        true,
        true,
        6,
        4,
        4
      ]
    },
    {
      "id": 9,
      "type": "PreviewImage",
      "pos": [
        950,
        400
      ],
      "size": [
        400,
        400
      ],
      "flags": {},
      "order": 11,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 10
        }
      ],
      "outputs": [],
      "title": "Generated Image",
      "properties": {
        "Node name for S&R": "PreviewImage"
      },
      "widgets_values": []
    },
    {
      "id": 10,
      "type": "HunyuanImageRefiner",
      "pos": [
        950,
        850
      ],
      "size": [
        400,
        300
      ],
      "flags": {},
      "order": 12,
      "mode": 0,
      "inputs": [
        {
          "name": "pipeline",
          "type": "HUNYUAN_PIPELINE",
          "link": 4
        },
        {
          "name": "image",
          "type": "IMAGE",
          "link": 11
        }
      ],
      "outputs": [
        {
          "name": "refined_image",
          "type": "IMAGE",
          "links": [
            13
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "HunyuanImageRefiner"
      },
      "widgets_values": [
        "Enhance details, improve sharpness and color vibrancy",
        "",
        6,
        4,
        42,
        5,
        5
      ]
    },
    {
      "id": 11,
      "type": "PreviewImage",
      "pos": [
        1400,
        850
      ],
      "size": [
        400,
        400
      ],
      "flags": {},
      "order": 14,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 13
        }
      ],
      "outputs": [],
      "title": "Refined Image",
      "properties": {
        "Node name for S&R": "PreviewImage"
      },
      "widgets_values": []
    },
    {
      "id": 12,
      "type": "HunyuanImageVAEEncode",
      "pos": [
        1418.3072509765625,
        501.30084228515625
      ],
      "size": [
        350,
        100
      ],
      "flags": {},
      "order": 1,
      "mode": 0,
      "inputs": [
        {
          "name": "pipeline",
          "type": "HUNYUAN_PIPELINE",
          "link": null
        },
        {
          "name": "image",
          "type": "IMAGE",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "latent",
          "type": "LATENT",
          "links": [
            14
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "HunyuanImageVAEEncode"
      },
      "widgets_values": []
    },
    {
      "id": 13,
      "type": "HunyuanImageVAEDecode",
      "pos": [
        1418.3072509765625,
        651.3005981445312
      ],
      "size": [
        350,
        100
      ],
      "flags": {},
      "order": 5,
      "mode": 0,
      "inputs": [
        {
          "name": "pipeline",
          "type": "HUNYUAN_PIPELINE",
          "link": null
        },
        {
          "name": "latent",
          "type": "LATENT",
          "link": 14
        }
      ],
      "outputs": [
        {
          "name": "image",
          "type": "IMAGE",
          "links": [
            15
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "HunyuanImageVAEDecode"
      },
      "widgets_values": []
    },
    {
      "id": 14,
      "type": "SaveImage",
      "pos": [
        1976.9705810546875,
        592.7169799804688
      ],
      "size": [
        350,
        270
      ],
      "flags": {},
      "order": 10,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 15
        }
      ],
      "outputs": [],
      "properties": {
        "Node name for S&R": "SaveImage"
      },
      "widgets_values": [
        "HunyuanAdvanced"
      ]
    },
    {
      "id": 15,
      "type": "Note",
      "pos": [
        50,
        1150
      ],
      "size": [
        750,
        250
      ],
      "flags": {},
      "order": 2,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "properties": {
        "text": "Advanced HunyuanImage Workflow with Quantization\n\nKey Features:\n1. INT8 quantization on DiT model for memory efficiency\n2. INT4 quantization on text encoder\n3. Torch compile with inductor backend and max-autotune mode\n4. Flash Attention and SDPA enabled\n5. 2048x2048 high-resolution generation\n6. Both prompt enhancement and image refinement enabled\n7. Memory management with cache clearing\n\nThis workflow demonstrates advanced optimization techniques for:\n- Reduced memory usage through quantization\n- Faster inference with torch compile\n- High-quality 2K image generation\n\nAdjust quantization methods and compile settings based on your hardware!"
      },
      "widgets_values": [
        ""
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 16,
      "type": "PreviewAny",
      "pos": [
        66.53873443603516,
        1037.5628662109375
      ],
      "size": [
        364.3172607421875,
        88
      ],
      "flags": {},
      "order": 6,
      "mode": 0,
      "inputs": [
        {
          "name": "source",
          "type": "*",
          "link": 16
        }
      ],
      "outputs": [],
      "properties": {
        "Node name for S&R": "PreviewAny"
      },
      "widgets_values": []
    },
    {
      "id": 17,
      "type": "PreviewAny",
      "pos": [
        511.51153564453125,
        981.572021484375
      ],
      "size": [
        364.3172607421875,
        88
      ],
      "flags": {},
      "order": 13,
      "mode": 0,
      "inputs": [
        {
          "name": "source",
          "type": "*",
          "link": 17
        }
      ],
      "outputs": [],
      "properties": {
        "Node name for S&R": "PreviewAny"
      },
      "widgets_values": []
    },
    {
      "id": 18,
      "type": "PreviewAny",
      "pos": [
        967.8214721679688,
        45.68438720703125
      ],
      "size": [
        364.3172607421875,
        88
      ],
      "flags": {},
      "order": 7,
      "mode": 0,
      "inputs": [
        {
          "name": "source",
          "type": "*",
          "link": 18
        }
      ],
      "outputs": [],
      "properties": {
        "Node name for S&R": "PreviewAny"
      },
      "widgets_values": []
    },
    {
      "id": 19,
      "type": "PreviewAny",
      "pos": [
        968.6764526367188,
        183.9659881591797
      ],
      "size": [
        364.3172607421875,
        88
      ],
      "flags": {},
      "order": 9,
      "mode": 0,
      "inputs": [
        {
          "name": "source",
          "type": "*",
          "link": 19
        }
      ],
      "outputs": [],
      "properties": {
        "Node name for S&R": "PreviewAny"
      },
      "widgets_values": []
    }
  ],
  "links": [
    [
      1,
      1,
      0,
      2,
      0,
      "HUNYUAN_PIPELINE"
    ],
    [
      2,
      1,
      0,
      4,
      0,
      "HUNYUAN_PIPELINE"
    ],
    [
      3,
      1,
      0,
      7,
      0,
      "HUNYUAN_PIPELINE"
    ],
    [
      4,
      1,
      0,
      10,
      0,
      "HUNYUAN_PIPELINE"
    ],
    [
      5,
      1,
      1,
      null,
      null,
      "HUNYUAN_CONFIG"
    ],
    [
      9,
      7,
      0,
      null,
      null,
      "LATENT"
    ],
    [
      10,
      7,
      1,
      9,
      0,
      "IMAGE"
    ],
    [
      11,
      7,
      1,
      10,
      1,
      "IMAGE"
    ],
    [
      13,
      10,
      0,
      11,
      0,
      "IMAGE"
    ],
    [
      14,
      12,
      0,
      13,
      1,
      "LATENT"
    ],
    [
      15,
      13,
      0,
      14,
      0,
      "IMAGE"
    ],
    [
      16,
      2,
      1,
      16,
      0,
      "*"
    ],
    [
      17,
      7,
      2,
      17,
      0,
      "*"
    ],
    [
      18,
      4,
      0,
      18,
      0,
      "*"
    ],
    [
      19,
      4,
      1,
      19,
      0,
      "*"
    ],
    [
      20,
      4,
      0,
      7,
      2,
      "STRING"
    ]
  ],
  "groups": [
    {
      "id": 1,
      "title": "Advanced Model Loading",
      "bounding": [
        40,
        20,
        420,
        800
      ],
      "color": "#3f789e",
      "font_size": 24,
      "flags": {}
    },
    {
      "id": 2,
      "title": "Memory Management",
      "bounding": [
        40,
        770,
        420,
        350
      ],
      "color": "#A88",
      "font_size": 24,
      "flags": {}
    },
    {
      "id": 3,
      "title": "Prompt Processing",
      "bounding": [
        490,
        -30,
        880,
        340
      ],
      "color": "#b58b2a",
      "font_size": 24,
      "flags": {}
    },
    {
      "id": 4,
      "title": "High-Res Generation",
      "bounding": [
        486.33843994140625,
        340.82855224609375,
        420,
        700
      ],
      "color": "#a1309b",
      "font_size": 24,
      "flags": {}
    },
    {
      "id": 5,
      "title": "Preview & Output",
      "bounding": [
        940,
        320,
        880,
        950
      ],
      "color": "#88A",
      "font_size": 24,
      "flags": {}
    },
    {
      "id": 6,
      "title": "VAE Operations",
      "bounding": [
        1408.3072509765625,
        421.3008117675781,
        370,
        350
      ],
      "color": "#8A8",
      "font_size": 24,
      "flags": {}
    }
  ],
  "config": {},
  "extra": {
    "info": "Advanced HunyuanImage 2.1 workflow with quantization, torch compile, and memory optimization",
    "author": "ComfyUI-HunyuanImage",
    "date": "2024",
    "features": [
      "INT8/INT4 quantization",
      "Torch compile with max-autotune",
      "Flash Attention",
      "2K resolution support",
      "Memory optimization"
    ],
    "ds": {
      "scale": 0.9613622857142871,
      "offset": [
        226.12726846012288,
        39.43296912035758
      ]
    },
    "frontendVersion": "1.25.11",
    "VHS_latentpreview": false,
    "VHS_latentpreviewrate": 0,
    "VHS_MetadataImage": true,
    "VHS_KeepIntermediate": true
  },
  "version": 0.4
}