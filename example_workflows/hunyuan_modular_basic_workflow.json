{
  "last_node_id": 20,
  "last_link_id": 25,
  "nodes": [
    {
      "id": 1,
      "type": "HunyuanImageDualTextEncoderLoader",
      "pos": [100, 100],
      "size": {"0": 400, "1": 200},
      "flags": {},
      "order": 0,
      "mode": 0,
      "outputs": [
        {
          "name": "dual_text_encoder",
          "type": "HUNYUAN_DUAL_TEXT_ENCODER",
          "links": [1],
          "shape": 3
        }
      ],
      "properties": {
        "Node name for S&R": "HunyuanImageDualTextEncoderLoader"
      },
      "widgets_values": [
        true,
        "cuda",
        "fp16",
        true,
        true
      ]
    },
    {
      "id": 2,
      "type": "HunyuanImagePromptEncoderDual",
      "pos": [550, 100],
      "size": {"0": 400, "1": 200},
      "flags": {},
      "order": 1,
      "mode": 0,
      "inputs": [
        {
          "name": "dual_text_encoder",
          "type": "HUNYUAN_DUAL_TEXT_ENCODER",
          "link": 1
        }
      ],
      "outputs": [
        {
          "name": "conditioning",
          "type": "HUNYUAN_CONDITIONING",
          "links": [2],
          "shape": 3
        }
      ],
      "properties": {
        "Node name for S&R": "HunyuanImagePromptEncoderDual"
      },
      "widgets_values": [
        "A majestic mountain landscape with snow-capped peaks under a starry night sky, aurora borealis dancing in the background, photorealistic, highly detailed, 8k resolution",
        "blurry, low quality, distorted, watermark"
      ]
    },
    {
      "id": 3,
      "type": "HunyuanImageDiTLoaderV2",
      "pos": [100, 350],
      "size": {"0": 400, "1": 200},
      "flags": {},
      "order": 2,
      "mode": 0,
      "outputs": [
        {
          "name": "dit_model",
          "type": "HUNYUAN_DIT",
          "links": [3],
          "shape": 3
        }
      ],
      "properties": {
        "Node name for S&R": "HunyuanImageDiTLoaderV2"
      },
      "widgets_values": [
        "hunyuanimage-v2.1",
        "cuda",
        "fp16",
        true,
        true
      ]
    },
    {
      "id": 4,
      "type": "HunyuanImageVAELoaderV2",
      "pos": [100, 600],
      "size": {"0": 400, "1": 150},
      "flags": {},
      "order": 3,
      "mode": 0,
      "outputs": [
        {
          "name": "vae",
          "type": "HUNYUAN_VAE",
          "links": [4, 10, 12],
          "shape": 3
        }
      ],
      "properties": {
        "Node name for S&R": "HunyuanImageVAELoaderV2"
      },
      "widgets_values": [
        "cuda",
        "fp16",
        false,
        true
      ]
    },
    {
      "id": 5,
      "type": "HunyuanImageSamplerV2",
      "pos": [550, 350],
      "size": {"0": 400, "1": 300},
      "flags": {},
      "order": 4,
      "mode": 0,
      "inputs": [
        {
          "name": "conditioning",
          "type": "HUNYUAN_CONDITIONING",
          "link": 2
        },
        {
          "name": "dit_model",
          "type": "HUNYUAN_DIT",
          "link": 3
        },
        {
          "name": "vae",
          "type": "HUNYUAN_VAE",
          "link": 4
        }
      ],
      "outputs": [
        {
          "name": "latent",
          "type": "LATENT",
          "links": [5, 7],
          "shape": 3
        }
      ],
      "properties": {
        "Node name for S&R": "HunyuanImageSamplerV2"
      },
      "widgets_values": [
        1024,
        1024,
        20,
        4.5,
        42,
        "dpm-solver",
        false
      ]
    },
    {
      "id": 6,
      "type": "HunyuanImageVAEDecodeV2",
      "pos": [1000, 350],
      "size": {"0": 300, "1": 100},
      "flags": {},
      "order": 5,
      "mode": 0,
      "inputs": [
        {
          "name": "latent",
          "type": "LATENT",
          "link": 5
        },
        {
          "name": "vae",
          "type": "HUNYUAN_VAE",
          "link": 10
        }
      ],
      "outputs": [
        {
          "name": "image",
          "type": "IMAGE",
          "links": [6],
          "shape": 3
        }
      ],
      "properties": {
        "Node name for S&R": "HunyuanImageVAEDecodeV2"
      }
    },
    {
      "id": 7,
      "type": "SaveImage",
      "pos": [1350, 350],
      "size": {"0": 300, "1": 270},
      "flags": {},
      "order": 6,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 6
        }
      ],
      "properties": {
        "Node name for S&R": "SaveImage"
      },
      "widgets_values": ["hunyuan_base"]
    },
    {
      "id": 10,
      "type": "Note",
      "pos": [100, 800],
      "size": {"0": 400, "1": 200},
      "flags": {},
      "order": 7,
      "mode": 0,
      "properties": {
        "text": "Base Generation Pipeline:\n1. Dual Text Encoder loads RePrompt + ByT5/Glyph\n2. Prompt Encoder processes text with enhancement\n3. DiT model generates latents\n4. VAE decodes to image\n\nMemory efficient: Samplers output latents only"
      },
      "widgets_values": ["Base Generation Pipeline:\n1. Dual Text Encoder loads RePrompt + ByT5/Glyph\n2. Prompt Encoder processes text with enhancement\n3. DiT model generates latents\n4. VAE decodes to image\n\nMemory efficient: Samplers output latents only"]
    },
    {
      "id": 11,
      "type": "HunyuanImageRefinerLoaderV2",
      "pos": [550, 700],
      "size": {"0": 400, "1": 200},
      "flags": {},
      "order": 8,
      "mode": 0,
      "outputs": [
        {
          "name": "refiner",
          "type": "HUNYUAN_REFINER",
          "links": [8],
          "shape": 3
        }
      ],
      "properties": {
        "Node name for S&R": "HunyuanImageRefinerLoaderV2"
      },
      "widgets_values": [
        "hunyuanimage-refiner",
        "cuda",
        "fp16",
        true,
        true
      ]
    },
    {
      "id": 12,
      "type": "HunyuanImageRefinerSampleV2",
      "pos": [1000, 700],
      "size": {"0": 400, "1": 200},
      "flags": {},
      "order": 9,
      "mode": 0,
      "inputs": [
        {
          "name": "latent",
          "type": "LATENT",
          "link": 7
        },
        {
          "name": "refiner",
          "type": "HUNYUAN_REFINER",
          "link": 8
        }
      ],
      "outputs": [
        {
          "name": "latent",
          "type": "LATENT",
          "links": [9],
          "shape": 3
        }
      ],
      "properties": {
        "Node name for S&R": "HunyuanImageRefinerSampleV2"
      },
      "widgets_values": [
        5,
        1.0
      ]
    },
    {
      "id": 13,
      "type": "HunyuanImageVAEDecodeV2",
      "pos": [1450, 700],
      "size": {"0": 300, "1": 100},
      "flags": {},
      "order": 10,
      "mode": 0,
      "inputs": [
        {
          "name": "latent",
          "type": "LATENT",
          "link": 9
        },
        {
          "name": "vae",
          "type": "HUNYUAN_VAE",
          "link": 12
        }
      ],
      "outputs": [
        {
          "name": "image",
          "type": "IMAGE",
          "links": [11],
          "shape": 3
        }
      ],
      "properties": {
        "Node name for S&R": "HunyuanImageVAEDecodeV2"
      }
    },
    {
      "id": 14,
      "type": "SaveImage",
      "pos": [1800, 700],
      "size": {"0": 300, "1": 270},
      "flags": {},
      "order": 11,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 11
        }
      ],
      "properties": {
        "Node name for S&R": "SaveImage"
      },
      "widgets_values": ["hunyuan_refined"]
    },
    {
      "id": 15,
      "type": "Note",
      "pos": [550, 950],
      "size": {"0": 400, "1": 150},
      "flags": {},
      "order": 12,
      "mode": 0,
      "properties": {
        "text": "Optional Refiner Pipeline:\n- Takes latents from base generation\n- Applies refinement steps\n- Outputs enhanced latents\n- Separate VAE decode for memory efficiency"
      },
      "widgets_values": ["Optional Refiner Pipeline:\n- Takes latents from base generation\n- Applies refinement steps\n- Outputs enhanced latents\n- Separate VAE decode for memory efficiency"]
    }
  ],
  "links": [
    [1, 1, 0, 2, 0, "HUNYUAN_DUAL_TEXT_ENCODER"],
    [2, 2, 0, 5, 0, "HUNYUAN_CONDITIONING"],
    [3, 3, 0, 5, 1, "HUNYUAN_DIT"],
    [4, 4, 0, 5, 2, "HUNYUAN_VAE"],
    [5, 5, 0, 6, 0, "LATENT"],
    [6, 6, 0, 7, 0, "IMAGE"],
    [7, 5, 0, 12, 0, "LATENT"],
    [8, 11, 0, 12, 1, "HUNYUAN_REFINER"],
    [9, 12, 0, 13, 0, "LATENT"],
    [10, 4, 0, 6, 1, "HUNYUAN_VAE"],
    [11, 13, 0, 14, 0, "IMAGE"],
    [12, 4, 0, 13, 1, "HUNYUAN_VAE"]
  ],
  "groups": [
    {
      "title": "Text Encoding (Dual Encoder)",
      "bounding": [80, 20, 900, 320],
      "color": "#3f789e"
    },
    {
      "title": "Base Generation",
      "bounding": [80, 270, 1600, 510],
      "color": "#4b7c4b"
    },
    {
      "title": "Refinement (Optional)",
      "bounding": [530, 620, 1600, 500],
      "color": "#7c4b4b"
    }
  ],
  "config": {},
  "extra": {
    "info": "HunyuanImage 2.1 workflow with dual text encoder (RePrompt + ByT5/Glyph)",
    "author": "ComfyUI-HunyuanImage",
    "date": "2024"
  },
  "version": 0.4
}